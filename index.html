<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ClipThreat Studio</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="icon" type="image/svg+xml" href="favicon.svg" />
  </head>
  <body>
    <header>
      <h1>🧪 ClipThreat Studio</h1>
      <p>クリップボード悪用攻撃の可視化＆体験ツール</p>
    </header>

    <nav class="tab-nav">
      <button class="tab-button active" data-tab="tab-clipboard">
        📋 基本操作
      </button>
      <button class="tab-button" data-tab="tab-watch">🔍 監視モード</button>
      <button class="tab-button" data-tab="tab-sniff">
        🎭 pasteスニッフィング
      </button>
      <button class="tab-button" data-tab="tab-clickfix">
        🚨 ClickFix攻撃
      </button>
      <button class="tab-button" data-tab="tab-autopaste">🧲 自動送信</button>
      <button class="tab-button" data-tab="tab-weirdchar">🧪 文字細工</button>
      <button class="tab-button" data-tab="tab-tips">
        🔒 セキュリティTips
      </button>
    </nav>

    <main>
      <section id="tab-clipboard" class="tab-content active">
        <h2>📋 クリップボード基本操作</h2>
        
        <div class="explanation-box">
          <h3>💡 使い方</h3>
          <ul>
            <li><strong>クリップボードから読み取る</strong>：現在クリップボードに保存されている内容を表示します</li>
            <li><strong>クリップボードに書き込む</strong>：テキストエリアの内容をクリップボードにコピーします</li>
            <li><strong>クリップボードをクリア</strong>：クリップボードを空にします</li>
          </ul>
          <div class="security-note">
            🔒 <strong>セキュリティ注意：</strong>クリップボードの読み取りはユーザーのプライバシーに関わるため、ブラウザーは必ず許可を求めます。
          </div>
        </div>
        
        <div class="tutorial-box">
          <h3>🎯 実際に試してみよう！</h3>
          <div class="tutorial-steps">
            <div class="step" id="step1">
              <span class="step-number">1</span>
              <div class="step-content">
                <p>まず、このテキストを選択してコピーしてみましょう：</p>
                <code class="sample-text" onclick="selectText(this)">クリップボードの実験テキストです🧪</code>
                <small>↑ クリックして選択 → Ctrl+Cでコピー</small>
              </div>
            </div>
            <div class="step" id="step2">
              <span class="step-number">2</span>
              <div class="step-content">
                <p>次に「📋 クリップボードから読み取る」ボタンをクリックして、コピーした内容を確認しましょう</p>
                <div class="permission-notice">
                  <strong>⚠️ 重要：</strong>ブラウザーから「クリップボードへのアクセスを許可しますか？」というダイアログが表示されます。<br>
                  これはセキュリティ上の保護機能です。今回は実験のため<strong>「許可」をクリック</strong>してください。
                </div>
              </div>
            </div>
            <div class="step" id="step3">
              <span class="step-number">3</span>
              <div class="step-content">
                <p>テキストエリアに好きな文字を入力して「✍️ クリップボードに書き込む」をクリック</p>
              </div>
            </div>
            <div class="step" id="step4">
              <span class="step-number">4</span>
              <div class="step-content">
                <p>他のアプリ（メモ帳など）やブラウザーの検索欄にて、Ctrl+Vで貼り付けて確認！</p>
              </div>
            </div>
          </div>
          <button class="tutorial-reset" onclick="resetTutorial()">🔄 チュートリアルをリセット</button>
        </div>
        
        <textarea
          id="clipboardInput"
          rows="4"
          placeholder="ここにテキストを入力してコピー・ペースト実験..."
        ></textarea>
        <div class="button-row">
          <button onclick="readClipboard()" title="クリップボードの現在の内容を表示">📋 クリップボードから読み取る</button>
          <button onclick="writeClipboard()" title="テキストエリアの内容をクリップボードにコピー">✍️ クリップボードに書き込む</button>
          <button onclick="clearClipboard()" title="クリップボードを空にする">🗑️ クリップボードをクリア</button>
        </div>
        <div class="info-text">
          <small>💡 Ctrl+Enterで書き込みも可能です</small>
        </div>
        <div id="clipboardOutput" class="output-box"></div>
      </section>

      <section id="tab-watch" class="tab-content">
        <h2>🔍 監視モード</h2>
        
        <div class="explanation-box">
          <h3>💡 この機能について</h3>
          <p>クリップボードの内容を定期的に監視し、変化を検出します。</p>
          <p class="warning-text">⚠️ これは悪用されると、ユーザーがコピーした情報を盗み見ることが可能です。</p>
          <div class="permission-notice">
            <strong>🔒 重要な注意事項：</strong><br>
            1. 初回使用時にブラウザーから許可ダイアログが表示されます。<strong>「許可」をクリック</strong>してください。<br>
            2. 監視中はこのタブをアクティブにしておいてください。他のタブやアプリに切り替えると監視が一時停止します。<br>
            3. ローカルファイル(file://)での実行は制限があります。HTTPサーバーでの実行を推奨します。
          </div>
        </div>
        
        <div class="tutorial-box">
          <h3>🎯 実際に試してみよう！</h3>
          <div class="tutorial-steps">
            <div class="step" id="watch-step1">
              <span class="step-number">1</span>
              <div class="step-content">
                <p>まず「📡 自動監視を有効にする」チェックボックスをオンにして監視を開始しましょう</p>
                <div class="permission-notice">
                  <strong>⚠️ 重要：</strong>ブラウザーから「クリップボードへのアクセスを許可しますか？」というダイアログが表示されます。<br>
                  <strong>「許可」をクリック</strong>してください。
                </div>
              </div>
            </div>
            <div class="step" id="watch-step2">
              <span class="step-number">2</span>
              <div class="step-content">
                <p>他のアプリ（メモ帳、ブラウザーなど）で何かテキストをコピーしてみましょう</p>
                <small>例：メモ帳に「テスト文字列」と入力してCtrl+A、Ctrl+C でコピー</small>
              </div>
            </div>
            <div class="step" id="watch-step3">
              <span class="step-number">3</span>
              <div class="step-content">
                <p>ClipThreat Studioの「監視モード」タブに戻ると、下のログにクリップボード変化が記録されているか確認</p>
                <small>💡 タブがアクティブでないと一部ブラウザーでは検出できない場合があります</small>
              </div>
            </div>
            <div class="step" id="watch-step4">
              <span class="step-number">4</span>
              <div class="step-content">
                <p>異なる種類のデータ（URL、メールアドレスなど）もコピーして、タイプ判別機能を確認してみましょう</p>
                <small>例：https://example.com、test@example.com など</small>
              </div>
            </div>
            <div class="step" id="watch-step5">
              <span class="step-number">5</span>
              <div class="step-content">
                <p>監視間隔を変更して、検出の反応速度の違いを体験してみましょう</p>
                <small>推奨：0.5秒にして素早い反応を確認後、5秒にして違いを体感</small>
              </div>
            </div>
          </div>
          <button class="tutorial-reset" onclick="resetWatchTutorial()">🔄 チュートリアルをリセット</button>
        </div>
        
        <div class="control-panel">
          <label class="watch-toggle">
            <input type="checkbox" id="watchToggle" />
            <span>📡 自動監視を有効にする</span>
          </label>
          
          <div class="interval-selector">
            <label>監視間隔：</label>
            <select id="watchInterval">
              <option value="500">0.5秒</option>
              <option value="1000" selected>1秒</option>
              <option value="2000">2秒</option>
              <option value="5000">5秒</option>
            </select>
          </div>
          
          <button onclick="clearWatchLog()" class="secondary-button">🗑️ ログをクリア</button>
        </div>
        
        <div class="stats-panel">
          <span id="watchStats">📊 監視状態：停止中 | 検出数：0</span>
        </div>
        
        <div id="watchLog" class="output-box watch-log"></div>
      </section>

      <section id="tab-sniff" class="tab-content">
        <h2>🎭 pasteスニッフィング</h2>
        <input id="sniffInput" placeholder="ここに貼り付けてください" />
        <div id="sniffLog" class="output-box"></div>
      </section>

      <section id="tab-clickfix" class="tab-content">
        <h2>🚨 ClickFix攻撃シミュレーション</h2>
        <p class="warning">
          あなたのシステムに問題が検出されました。今すぐ修復してください。
        </p>
        <button onclick="simulateClickFix()">✅ 修復する（推奨）</button>
        <div id="clickfixLog" class="output-box"></div>
      </section>

      <section id="tab-autopaste" class="tab-content">
        <h2>🧲 自動ペースト送信デモ</h2>
        <input
          id="autoInput"
          placeholder="ここにペーストすると即送信されます"
        />
        <div id="autoLog" class="output-box"></div>
      </section>

      <section id="tab-weirdchar" class="tab-content">
        <h2>🧪 不正文字列注入デモ</h2>
        <p>
          以下のボタンでゼロ幅スペースや右から左文字を含む文字列をコピーできます。
        </p>
        <button onclick="copyWeirdText()">不正文字列をコピーする</button>
        <div id="weirdOutput" class="output-box"></div>
      </section>

      <section id="tab-tips" class="tab-content">
        <h2>🔒 セキュリティTips</h2>
        <ul class="tips-list">
          <li>クリップボードの読み取りには通常、ユーザー操作が必要です</li>
          <li>HTTPSページでのみ `navigator.clipboard.readText()` は有効です</li>
          <li>「貼り付けるだけ」で情報が漏れるケースがあります</li>
          <li>オートフィルを活用し、コピー＆ペーストは最小限に</li>
        </ul>
      </section>
    </main>

    <footer>
      <div class="footer">
        🔗 GitHubリポジトリはこちら（
        <a href="https://github.com/ipusiron/clipthreat-studio" target="_blank"
          >ipusiron/clipthreat-studio</a
        >
        ）
      </div>
    </footer>
	
    <script src="js/main.js"></script>
    <script src="js/clipboard.js"></script>
    <script src="js/watch.js"></script>
    <script src="js/sniff.js"></script>
    <script src="js/clickfix.js"></script>
    <script src="js/autopaste.js"></script>
    <script src="js/weirdchar.js"></script>
    <script src="js/tips.js"></script>
  </body>
</html>
