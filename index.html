<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ClipThreat Studio</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="icon" type="image/svg+xml" href="favicon.svg" />
  </head>
  <body>
    <header>
      <div class="header-content">
        <div class="header-title">
          <h1>🧪 ClipThreat Studio</h1>
          <button class="help-button" onclick="showHelpModal()" title="ヘルプ・使い方を表示">❓</button>
        </div>
        <p>クリップボード悪用攻撃の可視化＆体験ツール</p>
      </div>
    </header>

    <nav class="tab-nav">
      <button class="tab-button active" data-tab="tab-clipboard">
        📋 基本操作
      </button>
      <button class="tab-button" data-tab="tab-watch">🔍 監視モード</button>
      <button class="tab-button" data-tab="tab-sniff">
        🎭 pasteイベントスニッフィング
      </button>
      <button class="tab-button" data-tab="tab-clickfix">
        🚨 ClickFix攻撃
      </button>
      <button class="tab-button" data-tab="tab-autopaste">🧲 自動送信</button>
      <button class="tab-button" data-tab="tab-weirdchar">🧪 文字細工</button>
      <button class="tab-button" data-tab="tab-tips">
        🔒 セキュリティTips
      </button>
    </nav>

    <main>
      <section id="tab-clipboard" class="tab-content active">
        <h2>📋 クリップボード基本操作</h2>
        
        <div class="explanation-box">
          <h3>💡 使い方</h3>
          <ul>
            <li><strong>クリップボードから読み取る</strong>：現在クリップボードに保存されている内容を表示します</li>
            <li><strong>クリップボードに書き込む</strong>：テキストエリアの内容をクリップボードにコピーします</li>
            <li><strong>クリップボードをクリア</strong>：クリップボードを空にします</li>
          </ul>
          <div class="security-note">
            🔒 <strong>セキュリティ注意：</strong>クリップボードの読み取りはユーザーのプライバシーに関わるため、ブラウザーは必ず許可を求めます。
          </div>
        </div>
        
        <div class="tutorial-box">
          <h3>🎯 実際に試してみよう！</h3>
          <div class="tutorial-steps">
            <div class="step" id="step1">
              <span class="step-number">1</span>
              <div class="step-content">
                <p>まず、このテキストを選択してコピーしてみましょう：</p>
                <code class="sample-text" onclick="selectText(this)">クリップボードの実験テキストです🧪</code>
                <small>↑ クリックして選択 → Ctrl+Cでコピー</small>
              </div>
            </div>
            <div class="step" id="step2">
              <span class="step-number">2</span>
              <div class="step-content">
                <p>次に「📋 クリップボードから読み取る」ボタンをクリックして、コピーした内容を確認しましょう</p>
                <div class="permission-notice">
                  <strong>⚠️ 重要：</strong>ブラウザーから「クリップボードへのアクセスを許可しますか？」というダイアログが表示されます。<br>
                  これはセキュリティ上の保護機能です。今回は実験のため<strong>「許可」をクリック</strong>してください。
                </div>
              </div>
            </div>
            <div class="step" id="step3">
              <span class="step-number">3</span>
              <div class="step-content">
                <p>テキストエリアに好きな文字を入力して「✍️ クリップボードに書き込む」をクリック</p>
              </div>
            </div>
            <div class="step" id="step4">
              <span class="step-number">4</span>
              <div class="step-content">
                <p>他のアプリ（メモ帳など）やブラウザーの検索欄にて、Ctrl+Vで貼り付けて確認！</p>
                <button class="step-ok-button" onclick="confirmStep4()" style="display: none; margin-top: 0.5rem;">✅ 確認できました</button>
              </div>
            </div>
          </div>
          <button class="tutorial-reset" onclick="resetTutorial()">🔄 チュートリアルをリセット</button>
        </div>
        
        <textarea
          id="clipboardInput"
          rows="4"
          placeholder="ここにテキストを入力してコピー・ペースト実験..."
        ></textarea>
        <div class="button-row">
          <button onclick="readClipboard()" title="クリップボードの現在の内容を表示">📋 クリップボードから読み取る</button>
          <button onclick="writeClipboard()" title="テキストエリアの内容をクリップボードにコピー">✍️ クリップボードに書き込む</button>
          <button onclick="clearClipboard()" title="クリップボードを空にする">🗑️ クリップボードをクリア</button>
          <button onclick="resetBasicDemo()" class="secondary-button" title="デモの状態をリセットする">🔄 デモをリセット</button>
        </div>
        <div class="info-text">
          <small>💡 Ctrl+Enterで書き込みも可能です</small>
        </div>
        <div id="clipboardOutput" class="output-box"></div>
      </section>

      <section id="tab-watch" class="tab-content">
        <h2>🔍 監視モード</h2>
        
        <div class="explanation-box">
          <h3>💡 この機能について</h3>
          <p>クリップボードの内容を定期的に監視し、変化を検出します。</p>
          <p class="warning-text">⚠️ これは悪用されると、ユーザーがコピーした情報を盗み見ることが可能です。</p>
          <div class="permission-notice">
            <strong>🔒 重要な注意事項：</strong><br>
            1. 初回使用時にブラウザーから許可ダイアログが表示されます。<strong>「許可」をクリック</strong>してください。<br>
            2. 監視中はこのタブをアクティブにしておいてください。他のタブやアプリに切り替えると監視が一時停止します。<br>
            3. ローカルファイル(file://)での実行は制限があります。HTTPサーバーでの実行を推奨します。
          </div>
        </div>
        
        <div class="tutorial-box">
          <h3>🎯 実際に試してみよう！</h3>
          <div class="tutorial-steps">
            <div class="step" id="watch-step1">
              <span class="step-number">1</span>
              <div class="step-content">
                <p>まず「📡 自動監視を有効にする」チェックボックスをオンにして監視を開始しましょう</p>
                <div class="permission-notice">
                  <strong>⚠️ 重要：</strong>ブラウザーから「クリップボードへのアクセスを許可しますか？」というダイアログが表示されます。<br>
                  <strong>「許可」をクリック</strong>してください。
                </div>
              </div>
            </div>
            <div class="step" id="watch-step2">
              <span class="step-number">2</span>
              <div class="step-content">
                <p>他のアプリ（メモ帳、ブラウザーなど）で何かテキストをコピーしてみましょう</p>
                <small>例：メモ帳に「テスト文字列」と入力してCtrl+A、Ctrl+C でコピー</small>
              </div>
            </div>
            <div class="step" id="watch-step3">
              <span class="step-number">3</span>
              <div class="step-content">
                <p>ClipThreat Studioの「監視モード」タブに戻ると、下のログにクリップボード変化が記録されているか確認</p>
                <small>💡 タブがアクティブでないと一部ブラウザーでは検出できない場合があります</small>
              </div>
            </div>
            <div class="step" id="watch-step4">
              <span class="step-number">4</span>
              <div class="step-content">
                <p>異なる種類のデータ（URL、メールアドレスなど）もコピーして、タイプ判別機能を確認してみましょう</p>
                <small>例：https://example.com、test@example.com など</small>
              </div>
            </div>
            <div class="step" id="watch-step5">
              <span class="step-number">5</span>
              <div class="step-content">
                <p>監視間隔を変更して、検出の反応速度の違いを体験してみましょう</p>
                <small>推奨：0.5秒にして素早い反応を確認後、5秒にして違いを体感</small>
                <button class="step-ok-button" onclick="confirmWatchStep5()" style="display: none; margin-top: 0.5rem;">✅ 体験できました</button>
              </div>
            </div>
          </div>
          <button class="tutorial-reset" onclick="resetWatchTutorial()">🔄 チュートリアルをリセット</button>
        </div>
        
        <div class="control-panel">
          <label class="watch-toggle">
            <input type="checkbox" id="watchToggle" />
            <span>📡 自動監視を有効にする</span>
          </label>
          
          <div class="interval-selector">
            <label>監視間隔：</label>
            <select id="watchInterval">
              <option value="500">0.5秒</option>
              <option value="1000" selected>1秒</option>
              <option value="2000">2秒</option>
              <option value="5000">5秒</option>
            </select>
          </div>
          
          <button onclick="clearWatchLog()" class="secondary-button">🗑️ ログをクリア</button>
        </div>
        
        <div class="stats-panel">
          <span id="watchStats">📊 監視状態：停止中 | 検出数：0</span>
        </div>
        
        <div id="watchLog" class="output-box watch-log"></div>
        
        <div id="watchCelebrationMessage" class="celebration-message" style="display: none;"></div>
      </section>

      <section id="tab-sniff" class="tab-content">
        <h2>🎭 pasteイベントスニッフィング</h2>
        
        <div class="explanation-box">
          <h3>💡 この機能について</h3>
          <p>pasteイベントスニフィングは、ユーザーが入力欄に貼り付けを行った瞬間に、その内容を<strong>傍受・記録</strong>する技術です。</p>
          <p><strong>仕組み：</strong>JavaScriptの<code>paste</code>イベントを使用して、クリップボードデータを読み取ります。</p>
          <div class="security-note">
            🔒 <strong>セキュリティリスク：</strong>悪意あるサイトが、パスワードや機密情報を含む貼り付け内容を盗み取る可能性があります。
          </div>
          <div style="background: #fff3e0; border: 1px solid #ffb74d; padding: 0.8rem; margin-top: 1rem; border-radius: 4px; font-size: 0.9rem;">
            <strong>📋 自動送信攻撃との違い：</strong><br>
            • <strong>pasteスニフィング</strong>：内容を傍受・記録（後で送信）<br>
            • <strong>自動送信攻撃</strong>：貼り付けと同時に即座に外部送信
          </div>
        </div>



        <div class="tutorial-box">
          <h3>🎯 実際に試してみよう！</h3>
          <div class="tutorial-steps">
            <div class="step" id="sniff-step1">
              <span class="step-number">1</span>
              <div class="step-content">
                <p>まず、テスト用の文字列をコピーしましょう（下の文字列をクリックして選択）</p>
                <code class="sample-text" onclick="selectSniffText(this)">テスト用パスワード: SecretPass123!</code>
                <small>↑ クリックして選択 → Ctrl+Cでコピー</small>
              </div>
            </div>
            <div class="step" id="sniff-step2">
              <span class="step-number">2</span>
              <div class="step-content">
                <p>下の入力欄に貼り付けてください（Ctrl+V）</p>
                <small>💡 貼り付けた瞬間にpasteイベントが発生し、内容が傍受されます</small>
              </div>
            </div>
            <div class="step" id="sniff-step3">
              <span class="step-number">3</span>
              <div class="step-content">
                <p>ログエリアに表示された傍受された内容を確認しましょう</p>
                <small>⚠️ 実際の攻撃では、この情報が攻撃者のサーバーに送信されます</small>
                <button class="step-ok-button" onclick="confirmStep3()" style="display: none; margin-top: 0.5rem;">✅ 理解しました</button>
              </div>
            </div>
            <div class="step" id="sniff-step4">
              <span class="step-number">4</span>
              <div class="step-content">
                <p>別の種類のデータも試してみましょう（クレジットカード風の数字）</p>
                <code class="sample-text" onclick="selectSniffText(this)">4111-1111-1111-1111</code>
                <small>↑ この偽カード番号をコピーして貼り付けてみてください</small>
              </div>
            </div>
            <div class="step" id="sniff-step5">
              <span class="step-number">5</span>
              <div class="step-content">
                <p>実際のWebサイトでは、このような危険性があることを覚えておきましょう</p>
                <small>🛡️ 重要な情報は信頼できるサイトでのみ貼り付けるようにしてください</small>
                <button class="step-ok-button" onclick="confirmStep5()" style="display: none; margin-top: 0.5rem;">✅ 理解しました</button>
              </div>
            </div>
          </div>
          <button class="tutorial-reset" onclick="resetSniffTutorial()">🔄 チュートリアルをリセット</button>
        </div>

        <div class="phishing-form-container">
          <div class="phishing-form">
            <div class="phishing-header">
              <span class="lock-icon">🔒</span>
              <h3>セキュアログインポータル（仮想のフィッシング詐欺ページ）</h3>
              <span class="warning-badge">安全</span>
            </div>
            <div class="phishing-content">
              <label for="sniffInput" class="phishing-label">
                パスワード / 認証コード / 機密情報
              </label>
              <input 
                id="sniffInput" 
                type="password" 
                placeholder="パスワードまたは認証コードを貼り付けてください..." 
                class="phishing-input"
              />
              <small class="phishing-hint">💡 パスワードマネージャーからの貼り付けも可能です</small>
            </div>
            <div class="phishing-footer">
              <span class="fake-secure">🛡️ SSL暗号化通信中</span>
              <span class="fake-verified">✓ 認証済みサイト</span>
            </div>
          </div>
        </div>
        
        <div id="sniffLog" class="output-box"></div>

        <div class="button-row">
          <button class="secondary-button" onclick="resetSniffDemo()">🔄 デモをリセット</button>
        </div>

        <div class="accordion-section">
          <div class="accordion-header" onclick="toggleAttackScenariosAccordion()">
            <h3>⚠️ 実際の攻撃シナリオを確認する</h3>
            <span class="accordion-icon">▼</span>
          </div>
          <div class="accordion-content" id="attackScenariosAccordionContent">
            <div class="explanation-box" style="background: #fff0f0; border-color: #ffc1c1; margin: 0;">
              <ul>
                <li><strong>フィッシングサイト</strong>：偽のログインフォームで、ユーザーがパスワードマネージャーから貼り付けたパスワードを盗取</li>
                <li><strong>偽の支払いページ</strong>：クレジットカード情報や暗号通貨ウォレットアドレスの貼り付けを監視</li>
                <li><strong>偽のファイル共有サイト</strong>：機密文書やプライベートキーの貼り付けを傍受</li>
                <li><strong>ソーシャルエンジニアリング</strong>：「エラーログを貼り付けてください」等の指示で、システム情報を取得</li>
                <li><strong>偽のサポートサイト</strong>：技術サポートを装い、設定ファイルやログファイルの貼り付けを要求</li>
                <li><strong>悪意あるWebアプリ</strong>：便利ツールを装い、ユーザーのデータ入力を監視</li>
              </ul>
              <div class="warning-text" style="margin-top: 1rem;">
                ⚠️ <strong>重要：</strong>この攻撃は、ユーザーが貼り付け操作を行うだけで実行されます。特別な権限や複雑な手順は不要です。
              </div>
            </div>
          </div>
        </div>

        <div class="accordion-section">
          <div class="accordion-header" onclick="toggleSniffAccordion()">
            <h3>🛡️ 対策方法を確認する</h3>
            <span class="accordion-icon">▼</span>
          </div>
          <div class="accordion-content" id="sniffAccordionContent">
            <div class="explanation-box" style="background: #f0fff0; border-color: #90ee90; margin: 0;">
              <ul>
                <li><strong>サイトの信頼性確認</strong>：URLやSSL証明書を必ず確認してから貼り付けを行う</li>
                <li><strong>手動入力の優先</strong>：重要な情報は可能な限り手動で入力する</li>
                <li><strong>ブラウザー拡張機能</strong>：pasteイベントを制限する拡張機能を使用</li>
                <li><strong>開発者ツール確認</strong>：F12キーで開発者ツールを開き、怪しいJavaScriptがないかチェック</li>
                <li><strong>パスワードマネージャーの活用</strong>：自動入力機能により貼り付けを避ける</li>
                <li><strong>コンテンツセキュリティポリシー</strong>：CSPヘッダーでJavaScriptの実行を制限</li>
                <li><strong>ブラウザーの設定</strong>：JavaScriptを部分的に無効化できるブラウザー設定を活用</li>
              </ul>
              <div class="security-note" style="margin-top: 1rem;">
                💡 <strong>開発者向け：</strong>ウェブサイト運営者は、pasteイベントリスナーの使用を最小限に抑え、必要な場合は透明性を保つことが重要です。
              </div>
            </div>
          </div>
        </div>
      </section>

      <section id="tab-clickfix" class="tab-content">
        <h2>🚨 ClickFix攻撃シミュレーション</h2>
        
        <div class="explanation-box">
          <h3>💡 ClickFix攻撃とは</h3>
          <p>ClickFix攻撃は、ユーザーを騙して悪意あるコマンドを実行させるソーシャルエンジニアリング攻撃です。</p>
          <p><strong>仕組み：</strong>偽のエラーメッセージや「修復」ボタンで、危険なコマンドをクリップボードにコピーし、実行を促します。</p>
          <div class="security-note">
            🔒 <strong>セキュリティリスク：</strong>一見無害なボタンクリックで、システム全体を乗っ取られる可能性があります。
          </div>
        </div>

        <div class="tutorial-box">
          <h3>🎯 ClickFix攻撃を体験しよう！</h3>
          <div class="tutorial-steps">
            <div class="step" id="clickfix-step1">
              <span class="step-number">1</span>
              <div class="step-content">
                <p>まず、上のClickFix攻撃の説明を読んで仕組みを理解しましょう</p>
                <small>💡 攻撃の概要と危険性を把握してから実際の体験に移ります</small>
                <button class="step-ok-button" onclick="confirmClickFixStep1()" style="margin-top: 0.5rem;">✅ ClickFix攻撃の説明を読んだ</button>
              </div>
            </div>
            <div class="step" id="clickfix-step2">
              <span class="step-number">2</span>
              <div class="step-content">
                <p>下の偽エラーダイアログの仕掛けを観察した後、「🔧 今すぐ修復する（推奨）」ボタンをクリックして攻撃の流れを体験</p>
                <small>💡 本物のエラーメッセージに見える視覚的トリック（点滅、緊急バッジ等）に注目<br>⚠️ 実際にはクリップボードに危険なコマンドがコピーされます</small>
              </div>
            </div>
            <div class="step" id="clickfix-step3">
              <span class="step-number">3</span>
              <div class="step-content">
                <p>下のログエリアで段階的な攻撃の進行を確認しましょう</p>
                <small>🎓 各ステップでの攻撃手法と危険性を学習</small>
                <button class="step-ok-button" onclick="confirmClickFixStep3()" style="display: none; margin-top: 0.5rem;">✅ ステップ4まで読んだ</button>
              </div>
            </div>
            <div class="step" id="clickfix-step4">
              <span class="step-number">4</span>
              <div class="step-content">
                <p>「❌ 後で修復」ボタンもクリックして、キャンセルボタンの罠を確認した後、下の対策方法を読みましょう</p>
                <small>🛡️ 安全な対処法と具体的な対策テクニックを学習</small>
                <button class="step-ok-button" onclick="confirmClickFixStep4()" style="display: none; margin-top: 0.5rem;">✅ 対策方法を読んだ</button>
              </div>
            </div>
          </div>
          <button class="tutorial-reset" onclick="resetClickFixTutorial()">🔄 チュートリアルをリセット</button>
        </div>

        <div class="clickfix-demo">
          <div class="fake-error-dialog">
            <div class="error-header">
              <span class="error-icon">⚠️</span>
              <h3>システムエラー - 緊急修復が必要</h3>
              <span class="urgent-badge">緊急</span>
            </div>
            <div class="error-content">
              <p class="error-message">
                <strong>重要な警告：</strong>システムファイルが破損しています。<br>
                すぐに修復しないと、データが失われる可能性があります。
              </p>
              <div class="error-details">
                エラーコード: 0x80070057<br>
                影響ファイル: system32\kernel.dll<br>
                推定修復時間: 2-3分
              </div>
            </div>
            <div class="error-actions">
              <button class="fix-button" onclick="simulateClickFix()">🔧 今すぐ修復する（推奨）</button>
              <button class="cancel-button" onclick="showCancelWarning()">❌ 後で修復</button>
            </div>
          </div>
        </div>
        
        <div class="button-row">
          <button onclick="resetClickFixDemo()" class="secondary-button">🔄 デモをリセット</button>
        </div>
        
        <div id="clickfixLog" class="output-box"></div>

        <div id="clickfixCelebrationMessage" class="celebration-message" style="display: none;"></div>

        <div class="accordion-section">
          <div class="accordion-header" onclick="toggleClickFixAccordion()">
            <h3>🛡️ ClickFix攻撃への対策方法</h3>
            <span class="accordion-icon">▼</span>
          </div>
          <div class="accordion-content" id="clickfixAccordionContent">
            <div class="explanation-box" style="background: #f0fff0; border-color: #90ee90; margin: 0;">
              <h4>🚨 即座に対処すべきこと</h4>
              <ul>
                <li><strong>ページを閉じる</strong>：「修復」や「キャンセル」ボタンを押さず、ブラウザーを閉じる</li>
                <li><strong>クリップボードを確認</strong>：怪しいコマンドがコピーされていないかチェック</li>
                <li><strong>PowerShell実行の回避</strong>：Win+Rダイアログでは絶対にコマンドを実行しない</li>
              </ul>
              
              <h4>🛡️ 予防対策</h4>
              <ul>
                <li><strong>疑いの習慣</strong>：突然のエラーメッセージやシステム警告は疑う</li>
                <li><strong>公式チャネルの利用</strong>：システム修復は公式サポートやWindows Updateで行う</li>
                <li><strong>URLの確認</strong>：信頼できないサイトでの作業を避ける</li>
                <li><strong>最新ブラウザーの使用</strong>：セキュリティ機能が向上したブラウザーを使用</li>
              </ul>
              
              <h4>⚙️ 技術的対策</h4>
              <ul>
                <li><strong>PowerShell実行ポリシー</strong>：ExecutionPolicyをRestrictedに設定</li>
                <li><strong>クリップボード監視ツール</strong>：怪しいコマンドのコピーを検知するツール使用</li>
                <li><strong>ブラウザー拡張機能</strong>：悪意あるスクリプトをブロックする拡張機能の導入</li>
                <li><strong>ユーザーアカウント制御(UAC)</strong>：管理者権限が必要な操作で確認ダイアログを表示</li>
              </ul>
              
              <div class="security-note" style="margin-top: 1rem;">
                💡 <strong>企業向け対策：</strong>社員教育でClickFix攻撃の認知度を高め、定期的なセキュリティ訓練を実施することが重要です。
              </div>
            </div>
          </div>
        </div>
      </section>

      <section id="tab-autopaste" class="tab-content">
        <h2>🧲 自動送信攻撃シミュレーション</h2>
        
        <div class="explanation-box">
          <h3>💡 自動送信攻撃とは</h3>
          <p>ユーザーが入力欄に貼り付けを行った瞬間に、その内容を攻撃者のサーバーへ<strong>即座に自動送信</strong>する攻撃です。</p>
          <p><strong>仕組み：</strong>pasteイベントと組み合わせて、即座にfetch()やXMLHttpRequestで外部サーバーに送信します。</p>
          <div class="security-note">
            🔒 <strong>セキュリティリスク：</strong>APIキー、設定ファイル、SSH鍵などが<strong>リアルタイムで</strong>攻撃者に送信されます。
          </div>
          <div style="background: #fff3e0; border: 1px solid #ffb74d; padding: 0.8rem; margin-top: 1rem; border-radius: 4px; font-size: 0.9rem;">
            <strong>📋 pasteスニフィングとの違い：</strong><br>
            • <strong>pasteスニフィング</strong>：内容を傍受・記録（後で送信）<br>
            • <strong>自動送信攻撃</strong>：貼り付けと同時に即座に外部送信
          </div>
        </div>

        <div class="tutorial-box">
          <h3>🎯 自動送信攻撃を体験しよう！</h3>
          <div class="tutorial-steps">
            <div class="step" id="auto-step1">
              <span class="step-number">1</span>
              <div class="step-content">
                <p>まず、上の自動送信攻撃の説明を読んで仕組みを理解しましょう</p>
                <small>💡 pasteスニフィングとの違いも確認してください</small>
                <button class="step-ok-button" onclick="confirmAutoStep1()" style="margin-top: 0.5rem;">✅ 攻撃の仕組みを理解した</button>
              </div>
            </div>
            <div class="step" id="auto-step2">
              <span class="step-number">2</span>
              <div class="step-content">
                <p>テスト用のAPIキーをコピーしましょう（下の文字列をクリックして選択）</p>
                <code class="sample-text" onclick="selectAutoText(this)">sk-1234567890abcdef1234567890abcdef1234567890abcdef</code>
                <small>↑ クリックして選択 → Ctrl+Cでコピー</small>
              </div>
            </div>
            <div class="step" id="auto-step3">
              <span class="step-number">3</span>
              <div class="step-content">
                <p>下の開発者コンソールの入力欄に貼り付けして自動送信攻撃を体験</p>
                <small>⚠️ 貼り付けた瞬間に外部サーバーへ自動送信されます</small>
              </div>
            </div>
            <div class="step" id="auto-step4">
              <span class="step-number">4</span>
              <div class="step-content">
                <p>ログで段階的な攻撃進行を確認し、リアルタイム送信の危険性を学習</p>
                <small>🎓 送信タイミングと影響について理解を深めましょう</small>
                <button class="step-ok-button" onclick="confirmAutoStep4()" style="display: none; margin-top: 0.5rem;">✅ 送信攻撃を理解した</button>
              </div>
            </div>
          </div>
          <button class="tutorial-reset" onclick="resetAutoTutorial()">🔄 チュートリアルをリセット</button>
        </div>

        <div class="autopaste-demo">
          <div class="dev-console-form">
            <div class="console-header">
              <span class="console-icon">💻</span>
              <span class="console-title">開発者コンソール</span>
              <span class="console-path">~/project/config</span>
            </div>
            <div class="console-content">
              <div class="console-prompt">
                <span class="prompt-symbol">$</span>
                <span class="prompt-text">環境変数とAPIキーの設定</span>
              </div>
              <label for="autoInput" class="console-label">
                APIキー / トークン / 設定値
              </label>
              <input
                id="autoInput"
                type="text"
                placeholder="export API_KEY=sk-1234... または設定値を貼り付けてください"
                class="console-input"
              />
              <small class="console-hint">💡 .env ファイルや設定ファイルからのコピー&ペーストが便利です</small>
            </div>
            <div class="console-footer">
              <span class="terminal-indicator">⚡ ターミナル接続中</span>
              <span class="secure-connection">🔒 SSH暗号化通信</span>
            </div>
          </div>
        </div>
        
        <div id="autoLog" class="output-box"></div>

        <div class="button-row">
          <button class="secondary-button" onclick="resetAutoDemo()">🔄 デモをリセット</button>
        </div>

        <div id="autoCelebrationMessage" class="celebration-message" style="display: none;"></div>

        <!-- 対策方法アコーディオン -->
        <div class="accordion-section">
          <div class="accordion-header" onclick="toggleAutoAccordion()">
            <h3>🛡️ 自動送信攻撃の対策方法</h3>
            <span class="accordion-icon">▼</span>
          </div>
          <div id="autoAccordionContent" class="accordion-content">
            <div class="explanation-box">
              <h3>🔧 技術的対策</h3>
              <ul>
                <li><strong>CSP (Content Security Policy)</strong>：外部への不正通信をブロック</li>
                <li><strong>CORS設定</strong>：信頼できるオリジンからの通信のみ許可</li>
                <li><strong>入力値サニタイゼーション</strong>：危険な文字列パターンの検出と除去</li>
                <li><strong>Rate Limiting</strong>：短時間での大量リクエストを制限</li>
                <li><strong>HTTPS強制</strong>：通信の暗号化でMITM攻撃を防止</li>
              </ul>
            </div>
            
            <div class="explanation-box">
              <h3>👤 ユーザー対策</h3>
              <ul>
                <li><strong>信頼できないサイトでの貼り付け回避</strong>：APIキーや設定情報は慎重に</li>
                <li><strong>ブラウザのセキュリティ設定</strong>：クリップボード権限の確認</li>
                <li><strong>開発者ツールでの検証</strong>：Networkタブでの通信監視</li>
                <li><strong>パスワードマネージャー活用</strong>：手動コピペの削減</li>
                <li><strong>定期的なAPIキー更新</strong>：漏洩リスクの最小化</li>
              </ul>
            </div>
            
            <div class="explanation-box">
              <h3>🏢 組織的対策</h3>
              <ul>
                <li><strong>セキュリティ教育</strong>：開発者向けのクリップボード攻撃啓発</li>
                <li><strong>コードレビュー</strong>：pasteイベントハンドラーの監査</li>
                <li><strong>監視システム</strong>：異常な外部通信の検知</li>
                <li><strong>インシデント対応</strong>：情報漏洩時の迅速な対処プロセス</li>
                <li><strong>定期的監査</strong>：Webアプリケーションのセキュリティチェック</li>
              </ul>
            </div>
            
            <div class="explanation-box">
              <h3>🚨 緊急時対応</h3>
              <ul>
                <li><strong>APIキー即座無効化</strong>：漏洩疑いがある場合の緊急停止</li>
                <li><strong>アクセスログ確認</strong>：不正使用の痕跡調査</li>
                <li><strong>通信ログ分析</strong>：データ送信先と内容の特定</li>
                <li><strong>被害範囲特定</strong>：影響を受けるシステムとデータの調査</li>
                <li><strong>関係者通知</strong>：セキュリティチームや管理者への報告</li>
              </ul>
            </div>
          </div>
        </div>
      </section>

      <section id="tab-weirdchar" class="tab-content">
        <h2>🧪 Unicode文字細工攻撃</h2>
        
        <div class="explanation-box">
          <h3>💡 Unicode文字細工攻撃とは</h3>
          <p>見た目上は正常に見えるが、実際は不正な文字（ゼロ幅文字、制御文字、RTL文字など）を含む文字列を使った攻撃手法です。</p>
          <p><strong>危険性：</strong>ファイル名偽装、フィッシング詐欺、セキュリティ検証の回避などに悪用される可能性があります。</p>
          <div class="security-note">
            🔒 <strong>攻撃例：</strong>実行ファイル(.exe)をクリック率の高い画像ファイル(.jpg)に見せかける、URLを偽装するなど
          </div>
        </div>

        <div class="tutorial-box">
          <h3>🎯 Unicode攻撃を体験しよう！</h3>
          <div class="tutorial-steps">
            <div class="step" id="weird-step1">
              <span class="step-number">1</span>
              <div class="step-content">
                <p>まず基本的なゼロ幅スペース攻撃を体験しましょう</p>
                <small>一見普通のファイル名に見えますが、隠された文字が含まれています</small>
                <button class="step-ok-button" onclick="confirmWeirdStep1()" style="display: inline-block; margin-top: 0.5rem;">✅ 理解しました</button>
              </div>
            </div>
            <div class="step" id="weird-step2">
              <span class="step-number">2</span>
              <div class="step-content">
                <p>ゼロ幅スペース混入ファイル名をコピーして体験してください</p>
                <small>💡 下のボタンをクリックしてからテキストエディタに貼り付けてみてください</small>
              </div>
            </div>
            <div class="step" id="weird-step3">
              <span class="step-number">3</span>
              <div class="step-content">
                <p>今度はRTL（右から左）文字によるファイル拡張子偽装を体験しましょう</p>
                <small>⚠️ 実行ファイルが画像ファイルに見えるトリックです</small>
              </div>
            </div>
            <div class="step" id="weird-step4">
              <span class="step-number">4</span>
              <div class="step-content">
                <p>すべての攻撃パターンを理解できました</p>
                <small>🎓 これらの手法がどのように悪用されるかを確認しましょう</small>
                <button class="step-ok-button" onclick="confirmWeirdStep4()" style="display: none; margin-top: 0.5rem;">✅ 完全理解しました</button>
              </div>
            </div>
          </div>
          <button class="tutorial-reset" onclick="resetWeirdTutorial()">🔄 チュートリアルをリセット</button>
        </div>

        <div class="explanation-box" style="background: #fff8e1; border-color: #ffcc02;">
          <h3>🎯 攻撃実演デモ</h3>
          <div class="button-row">
            <button onclick="copyZeroWidthSpaces()" title="ゼロ幅文字が混入されたファイル名をコピー">📁 ゼロ幅スペース攻撃</button>
            <button onclick="copyRTLTrick()" title="RTL文字による拡張子偽装をコピー">🔄 RTL拡張子偽装</button>
            <button onclick="copyMixedScript()" title="複数スクリプトが混在した文字列をコピー">🌐 スクリプト混在攻撃</button>
            <button onclick="copyHomographAttack()" title="同形異義文字による偽装をコピー">👥 同形異義文字攻撃</button>
          </div>
        </div>
        
        <div id="weirdOutput" class="output-box"></div>

        <div class="button-row">
          <button class="secondary-button" onclick="resetWeirdDemo()">🔄 デモをリセット</button>
        </div>

        <div id="weirdCelebrationMessage" class="celebration-message" style="display: none;"></div>

        <!-- 攻撃詳細アコーディオン -->
        <div class="accordion-section">
          <div class="accordion-header" onclick="toggleWeirdAttackAccordion()">
            <h3>⚠️ 実際の攻撃シナリオ詳細</h3>
            <span class="accordion-icon">▼</span>
          </div>
          <div id="weirdAttackAccordionContent" class="accordion-content">
            <div class="explanation-box" style="background: #fff0f0; border-color: #ffc1c1; margin: 0;">
              <h3>🎭 ゼロ幅スペース攻撃</h3>
              <ul>
                <li><strong>ファイル名偽装</strong>：flag.txt が実際は fla[ZWSP]g.txt となっている</li>
                <li><strong>検索回避</strong>：システムの検索機能で見つからないファイル名を作成</li>
                <li><strong>重複ファイル作成</strong>：見た目上同じ名前で複数ファイルを作成</li>
                <li><strong>セキュリティツール回避</strong>：ブラックリストに載ったファイル名の検出回避</li>
              </ul>
              
              <h3>🔄 RTL文字攻撃</h3>
              <ul>
                <li><strong>拡張子偽装</strong>：evil[RTL]gnp.exe が exe.png に見える</li>
                <li><strong>URL偽装</strong>：悪意あるドメインを信頼できるサイトに見せかけ</li>
                <li><strong>フィッシング詐欺</strong>：正規サイトそっくりのURLを作成</li>
                <li><strong>マルウェア配布</strong>：実行ファイルを無害なファイルに偽装</li>
              </ul>
              
              <h3>👥 同形異義文字攻撃</h3>
              <ul>
                <li><strong>ドメインなりすまし</strong>：аpple.com（キリル文字のа）でapple.comを偽装</li>
                <li><strong>IDN偽装攻撃</strong>：国際化ドメイン名の脆弱性を悪用</li>
                <li><strong>認証情報詐取</strong>：正規サイトと見分けがつかない偽サイト作成</li>
                <li><strong>ソーシャルエンジニアリング</strong>：信頼性の高い企業名を模倣</li>
              </ul>
              
              <div class="warning-text" style="margin-top: 1rem;">
                ⚠️ <strong>重要：</strong>これらの攻撃は視覚的に判別が困難で、技術的な知識がない一般ユーザーでも簡単に騙される可能性があります。
              </div>
            </div>
          </div>
        </div>

        <!-- 対策方法アコーディオン -->
        <div class="accordion-section">
          <div class="accordion-header" onclick="toggleWeirdCountermeasuresAccordion()">
            <h3>🛡️ Unicode攻撃の対策方法</h3>
            <span class="accordion-icon">▼</span>
          </div>
          <div id="weirdCountermeasuresAccordionContent" class="accordion-content">
            <div class="explanation-box" style="background: #f0fff0; border-color: #90ee90; margin: 0;">
              <h3>🔧 技術的対策</h3>
              <ul>
                <li><strong>文字列正規化</strong>：Unicode正規化（NFC、NFD）でゼロ幅文字を除去</li>
                <li><strong>文字種制限</strong>：許可する文字セットを明確に定義</li>
                <li><strong>IDN表示</strong>：ブラウザーでPunycodeを表示させる設定</li>
                <li><strong>ファイル名検証</strong>：制御文字やRTL文字の混入を検出</li>
                <li><strong>フォント設定</strong>：ゼロ幅文字を可視化するフォント使用</li>
              </ul>
              
              <h3>👤 ユーザー対策</h3>
              <ul>
                <li><strong>URL確認</strong>：アドレスバーを注意深く確認する</li>
                <li><strong>ファイル検証</strong>：ダウンロードしたファイルの拡張子を確認</li>
                <li><strong>ブックマーク活用</strong>：重要なサイトは手動入力ではなくブックマークから</li>
                <li><strong>セキュリティソフト</strong>：最新のアンチウイルスソフトを使用</li>
                <li><strong>デベロッパーツール活用</strong>：疑わしいファイル名をコピーして検証</li>
              </ul>
              
              <h3>🏢 システム対策</h3>
              <ul>
                <li><strong>入力値検証</strong>：Webアプリケーションでの厳密な文字種チェック</li>
                <li><strong>ファイルアップロード制限</strong>：不正文字を含むファイル名の拒否</li>
                <li><strong>メール フィルタリング</strong>：不正なUnicode文字を含むメールの検出</li>
                <li><strong>DNS設定</strong>：IDN偽装攻撃に対するDNSフィルタリング</li>
                <li><strong>定期監査</strong>：システム内の不正ファイル名の定期チェック</li>
              </ul>
              
              <div class="security-note" style="margin-top: 1rem;">
                💡 <strong>開発者向け：</strong>入力値の検証時は視覚的な類似性だけでなく、Unicode文字の実際のコードポイントを確認することが重要です。
              </div>
            </div>
          </div>
        </div>
      </section>

      <section id="tab-tips" class="tab-content">
        <h2>🔒 クリップボードセキュリティ完全ガイド</h2>
        
        <div class="explanation-box">
          <h3>💡 このガイドについて</h3>
          <p>このタブでは、クリップボード関連の脅威に対する包括的なセキュリティ対策をまとめています。</p>
          <p><strong>対象：</strong>一般ユーザー、開発者、システム管理者、情報セキュリティ担当者</p>
          <div class="security-note">
            🎯 <strong>学習目標：</strong>クリップボード攻撃を理解し、適切な対策を実装・運用できるようになる
          </div>
        </div>

        <!-- 一般ユーザー向けTips -->
        <div class="accordion-section">
          <div class="accordion-header" onclick="toggleUserTipsAccordion()">
            <h3>👤 一般ユーザー向けセキュリティ対策</h3>
            <span class="accordion-icon">▼</span>
          </div>
          <div id="userTipsAccordionContent" class="accordion-content">
            <div class="explanation-box" style="background: #f0f8ff; border-color: #87ceeb; margin: 0;">
              <h3>🔒 基本的な安全対策</h3>
              <ul>
                <li><strong>信頼できないサイトでの貼り付け回避</strong>：パスワード、APIキー、個人情報は信頼できるサイトでのみ貼り付け</li>
                <li><strong>ブラウザーの権限確認</strong>：クリップボードアクセス許可ダイアログは慎重に判断</li>
                <li><strong>パスワードマネージャー活用</strong>：自動入力機能でコピペのリスクを削減</li>
                <li><strong>貼り付け前の確認</strong>：重要な情報は貼り付け前に内容を確認</li>
                <li><strong>定期的なクリップボードクリア</strong>：機密情報使用後はクリップボードを空にする</li>
              </ul>
              
              <h3>⚠️ 危険な行動パターン</h3>
              <ul>
                <li><strong>フィッシングサイトでの貼り付け</strong>：URLを確認せずパスワードを貼り付け</li>
                <li><strong>公共端末での機密情報コピー</strong>：共有PCでのパスワードやカード情報の使用</li>
                <li><strong>メール・チャットでの直接貼り付け</strong>：暗号化されていない通信での機密情報共有</li>
                <li><strong>不明なサイトでの「修復」ボタンクリック</strong>：ClickFix攻撃への対応</li>
                <li><strong>ファイル名の見た目だけで判断</strong>：Unicode攻撃による偽装の見落とし</li>
              </ul>
              
              <h3>🛡️ 推奨ツールと設定</h3>
              <ul>
                <li><strong>ブラウザー設定</strong>：不要なサイトからのクリップボードアクセスを制限</li>
                <li><strong>セキュリティ拡張機能</strong>：クリップボード保護機能を持つ拡張機能の導入</li>
                <li><strong>アンチウイルスソフト</strong>：クリップボード監視機能を持つ製品の選択</li>
                <li><strong>2要素認証</strong>：パスワード漏洩時のリスク軽減</li>
                <li><strong>定期的なパスワード更新</strong>：漏洩リスクを考慮した運用</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- 開発者向けTips -->
        <div class="accordion-section">
          <div class="accordion-header" onclick="toggleDeveloperTipsAccordion()">
            <h3>💻 開発者向けセキュリティ実装</h3>
            <span class="accordion-icon">▼</span>
          </div>
          <div id="developerTipsAccordionContent" class="accordion-content">
            <div class="explanation-box" style="background: #f0fff0; border-color: #90ee90; margin: 0;">
              <h3>🔧 技術的対策の実装</h3>
              <ul>
                <li><strong>CSP (Content Security Policy)</strong>：外部への不正通信をブロックするヘッダー設定</li>
                <li><strong>入力値検証</strong>：pasteイベントで取得したデータの厳密なバリデーション</li>
                <li><strong>Rate Limiting</strong>：短時間での大量リクエストを制限するAPI設計</li>
                <li><strong>ログ記録</strong>：異常なクリップボード操作やpaste イベントの監視</li>
                <li><strong>暗号化</strong>：機密データの暗号化保存と通信</li>
              </ul>
              
              <h3>📝 安全なコーディング慣行</h3>
              <ul>
                <li><strong>pasteイベントの最小限使用</strong>：必要最小限での利用とユーザーへの透明性確保</li>
                <li><strong>データサニタイゼーション</strong>：ユーザー入力の適切な無害化処理</li>
                <li><strong>HTTPS強制</strong>：全通信の暗号化とMITM攻撃対策</li>
                <li><strong>エラーハンドリング</strong>：機密情報を含まないエラーメッセージ</li>
                <li><strong>セキュリティテスト</strong>：定期的な脆弱性スキャンとペネトレーションテスト</li>
              </ul>
              
              <h3>🎓 セキュアな開発例</h3>
              <ul>
                <li><strong>Clipboard API の適切な使用</strong>：権限チェックとエラーハンドリング</li>
                <li><strong>フロントエンド保護</strong>：重要な処理はサーバーサイドで実行</li>
                <li><strong>監査ログ</strong>：セキュリティイベントの記録と分析</li>
                <li><strong>依存関係管理</strong>：サードパーティライブラリの脆弱性管理</li>
                <li><strong>セキュリティヘッダー</strong>：包括的なHTTPセキュリティヘッダーの設定</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- システム管理者向けTips -->
        <div class="accordion-section">
          <div class="accordion-header" onclick="toggleAdminTipsAccordion()">
            <h3>🏢 システム管理者向け運用対策</h3>
            <span class="accordion-icon">▼</span>
          </div>
          <div id="adminTipsAccordionContent" class="accordion-content">
            <div class="explanation-box" style="background: #fff0f5; border-color: #dda0dd; margin: 0;">
              <h3>🛡️ 組織レベルでの対策</h3>
              <ul>
                <li><strong>ポリシー策定</strong>：クリップボード使用に関するセキュリティポリシーの制定</li>
                <li><strong>従業員教育</strong>：定期的なセキュリティ意識向上トレーニング</li>
                <li><strong>技術的制御</strong>：エンドポイント保護ソフトによるクリップボード監視</li>
                <li><strong>ネットワーク監視</strong>：異常な外部通信の検出と分析</li>
                <li><strong>インシデント対応</strong>：クリップボード関連の情報漏洩対応手順</li>
              </ul>
              
              <h3>📊 監視と分析</h3>
              <ul>
                <li><strong>ログ分析</strong>：Webアプリケーションログでの異常検出</li>
                <li><strong>ネットワーク分析</strong>：DLP (Data Loss Prevention) ツールの活用</li>
                <li><strong>エンドポイント監視</strong>：不審なクリップボード操作の検出</li>
                <li><strong>脅威インテリジェンス</strong>：最新の攻撃手法情報の収集</li>
                <li><strong>定期的監査</strong>：セキュリティ対策の有効性評価</li>
              </ul>
              
              <h3>🚨 インシデント対応</h3>
              <ul>
                <li><strong>初動対応</strong>：クリップボード攻撃が疑われる場合の緊急手順</li>
                <li><strong>証拠保全</strong>：フォレンジック調査のためのデータ保存</li>
                <li><strong>影響評価</strong>：漏洩したデータの範囲と影響度の評価</li>
                <li><strong>復旧手順</strong>：システムとデータの安全な復旧プロセス</li>
                <li><strong>事後対策</strong>：再発防止のための改善施策</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- 緊急対応ガイド -->
        <div class="accordion-section">
          <div class="accordion-header" onclick="toggleEmergencyAccordion()">
            <h3>🚨 緊急時対応ガイド</h3>
            <span class="accordion-icon">▼</span>
          </div>
          <div id="emergencyAccordionContent" class="accordion-content">
            <div class="explanation-box" style="background: #fff5f5; border-color: #ffc1c1; margin: 0;">
              <h3>⚡ クリップボード攻撃を受けた場合</h3>
              <ol style="line-height: 1.8;">
                <li><strong>即座に切断</strong>：疑わしいサイトからすぐに離れる</li>
                <li><strong>クリップボードクリア</strong>：機密情報をクリップボードから削除</li>
                <li><strong>パスワード変更</strong>：影響を受ける可能性のあるアカウント</li>
                <li><strong>2要素認証確認</strong>：不審なログイン試行をチェック</li>
                <li><strong>ネットワーク遮断</strong>：必要に応じてネットワーク接続を切断</li>
                <li><strong>セキュリティチーム連絡</strong>：組織内での報告と連携</li>
                <li><strong>証拠保全</strong>：スクリーンショットやログの保存</li>
                <li><strong>影響調査</strong>：漏洩した可能性のあるデータの特定</li>
              </ol>
              
              <h3>🔍 被害確認の方法</h3>
              <ul>
                <li><strong>ブラウザーの開発者ツール</strong>：Networkタブで不審な通信を確認</li>
                <li><strong>アカウント活動ログ</strong>：各サービスでの異常なアクセス履歴をチェック</li>
                <li><strong>クレジットカード明細</strong>：不正利用がないかの確認</li>
                <li><strong>システムログ</strong>：企業環境での異常なアクセスパターン検出</li>
                <li><strong>メール確認</strong>：アカウント変更通知などの有無</li>
              </ul>
              
              <h3>📞 連絡先と報告</h3>
              <ul>
                <li><strong>組織内セキュリティチーム</strong>：社内CSIRT or情報システム部門</li>
                <li><strong>関連サービス提供者</strong>：影響を受けた可能性のあるサービス</li>
                <li><strong>法執行機関</strong>：重大な被害の場合はサイバー犯罪相談窓口</li>
                <li><strong>セキュリティベンダー</strong>：インシデント対応支援の要請</li>
                <li><strong>保険会社</strong>：サイバー保険加入時の連絡</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- 最新脅威情報 -->
        <div class="accordion-section">
          <div class="accordion-header" onclick="toggleThreatInfoAccordion()">
            <h3>🔍 最新脅威動向と対策トレンド</h3>
            <span class="accordion-icon">▼</span>
          </div>
          <div id="threatInfoAccordionContent" class="accordion-content">
            <div class="explanation-box" style="background: #f8f8ff; border-color: #dcd0ff; margin: 0;">
              <h3>📈 2024年のクリップボード攻撃トレンド</h3>
              <ul>
                <li><strong>AI生成フィッシング</strong>：より巧妙化するソーシャルエンジニアリング手法</li>
                <li><strong>モバイル端末への拡大</strong>：スマートフォン・タブレットでの攻撃増加</li>
                <li><strong>ゼロクリック攻撃</strong>：ユーザー操作を必要としない高度な攻撃</li>
                <li><strong>サプライチェーン攻撃</strong>：信頼できるソフトウェアの悪用</li>
                <li><strong>暗号資産狙い撃ち</strong>：ウォレットアドレスやシードフレーズの狙い撃ち</li>
              </ul>
              
              <h3>🛡️ 新しい防御技術</h3>
              <ul>
                <li><strong>機械学習ベースの検知</strong>：異常な貼り付けパターンの自動検出</li>
                <li><strong>ゼロトラストアーキテクチャ</strong>：すべての通信を検証する設計</li>
                <li><strong>行動分析</strong>：ユーザーの正常な行動パターンとの比較</li>
                <li><strong>リアルタイム脅威インテリジェンス</strong>：最新攻撃手法の即座な対応</li>
                <li><strong>分離実行環境</strong>：仮想環境での安全な操作</li>
              </ul>
              
              <h3>🎯 今後予想される脅威</h3>
              <ul>
                <li><strong>量子コンピューティング対応</strong>：既存暗号化の突破と対策</li>
                <li><strong>IoTデバイス連携攻撃</strong>：複数デバイス間でのクリップボード共有悪用</li>
                <li><strong>VR/AR環境での攻撃</strong>：新しいインターフェースでの脅威</li>
                <li><strong>生体認証の回避</strong>：バイオメトリクス技術への対応</li>
                <li><strong>クラウドサービス悪用</strong>：合法的サービスを使った攻撃手法</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- チェックリスト -->
        <div class="explanation-box" style="background: #f0f8f0; border-color: #98fb98; margin-top: 2rem;">
          <h3>✅ セキュリティチェックリスト</h3>
          <div class="button-row">
            <button onclick="showUserChecklist()" title="個人ユーザー向けチェック項目">👤 個人用チェック</button>
            <button onclick="showDeveloperChecklist()" title="開発者向けチェック項目">💻 開発者用チェック</button>
            <button onclick="showAdminChecklist()" title="システム管理者向けチェック項目">🏢 管理者用チェック</button>
            <button onclick="resetTipsDemo()" class="secondary-button">🔄 リセット</button>
          </div>
        </div>

        <div id="tipsOutput" class="output-box">
          <div class="message info">📋 上のボタンからセキュリティチェックリストを表示できます。自身の役割に応じて確認してください。</div>
        </div>
      </section>
    </main>

    <!-- ヘルプモーダル -->
    <div id="helpModal" class="modal" style="display: none;">
      <div class="modal-content">
        <div class="modal-header">
          <h2>❓ ClipThreat Studio ヘルプ</h2>
          <button class="modal-close" onclick="closeHelpModal()">×</button>
        </div>
        <div class="modal-body">
          <div class="help-section">
            <h3>🎯 このツールについて</h3>
            <p>ClipThreat Studioは、クリップボード関連のセキュリティ脅威を体験・学習するための教育ツールです。</p>
          </div>
          
          <div class="help-section">
            <h3>📋 各タブの機能</h3>
            <ul>
              <li><strong>📋 基本操作</strong>：クリップボードAPIの基本的な読み書き操作を体験</li>
              <li><strong>🔍 監視モード</strong>：クリップボード内容の自動監視機能を体験</li>
              <li><strong>🎭 pasteイベントスニッフィング</strong>：貼り付け内容の傍受攻撃を体験</li>
              <li><strong>🚨 ClickFix攻撃</strong>：偽の修復ボタンによる攻撃手法を体験</li>
              <li><strong>🧲 自動送信</strong>：貼り付けと同時に外部送信される攻撃を体験</li>
              <li><strong>🧪 文字細工</strong>：Unicode文字を悪用した攻撃手法を体験</li>
              <li><strong>🔒 セキュリティTips</strong>：包括的なセキュリティ対策ガイド</li>
            </ul>
          </div>
          
          <div class="help-section">
            <h3>🔧 使い方のコツ</h3>
            <ul>
              <li><strong>チュートリアル</strong>：各タブにある「実際に試してみよう！」から始めてください</li>
              <li><strong>ステップ進行</strong>：OKボタンを押してステップを進めながら学習できます</li>
              <li><strong>リセット機能</strong>：各タブのリセットボタンで初期状態に戻せます</li>
              <li><strong>詳細調査</strong>：文字細工タブではWeirdString Inspectorと連携できます</li>
            </ul>
          </div>
          
          <div class="help-section">
            <h3>⚠️ 注意事項</h3>
            <ul>
              <li>このツールは<strong>教育目的</strong>でのみ使用してください</li>
              <li>実際の攻撃には使用しないでください</li>
              <li>HTTPS環境でのみ正常に動作します</li>
              <li>ブラウザーによってはクリップボード権限の許可が必要です</li>
            </ul>
          </div>
          
          <div class="help-section">
            <h3>🔗 関連リンク</h3>
            <ul>
              <li><a href="https://github.com/ipusiron/clipthreat-studio" target="_blank">GitHubリポジトリ</a></li>
              <li><a href="https://ipusiron.github.io/weirdstring-inspector/" target="_blank">WeirdString Inspector</a></li>
              <li><a href="https://akademeia.info/?page_id=42163" target="_blank">生成AIで作るセキュリティツール100</a></li>
            </ul>
          </div>
        </div>
        <div class="modal-footer">
          <button onclick="closeHelpModal()" class="button">閉じる</button>
        </div>
      </div>
    </div>

    <footer>
      <div class="footer">
        🔗 GitHubリポジトリはこちら（
        <a href="https://github.com/ipusiron/clipthreat-studio" target="_blank"
          >ipusiron/clipthreat-studio</a
        >
        ）
      </div>
    </footer>
	
    <script src="js/main.js"></script>
    <script src="js/clipboard.js"></script>
    <script src="js/watch.js"></script>
    <script src="js/sniff.js"></script>
    <script src="js/clickfix.js"></script>
    <script src="js/autopaste.js"></script>
    <script src="js/weirdchar.js"></script>
    <script src="js/tips.js"></script>
  </body>
</html>
